

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@eeic_sovereign" />
<meta property="og:site_name" content="TechNote of soblin">
<meta property="og:title" content="Technote of Soblin">
<meta property='og:url' content="https://soblin.github.io/technote/index.html">
<meta property='og:image' content="https://soblin.github.io/technote/_static/icon.png"/>


  
  
    <link rel="shortcut icon" href="../_static/icon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/my_theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="../genindex.html"/>
        <link rel="search" title="検索" href="../search.html"/>
    <link rel="top" title="TechNote of soblin  ドキュメント" href="../index.html"/>
        <link rel="up" title="Control" href="index.html"/>
        <link rel="next" title="Differential Flatness of Mechanical Control Systems: A Catalogue of Prototype Systems" href="murray_flatness.html"/>
        <link rel="prev" title="Control" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> TechNote of soblin
          

          
          </a>

          
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../motion_planning/index.html">Motion Planning</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Control</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Feedback Linearization using Gaussian Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abstract">Abstract</a></li>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#probem-formlation">Probem Formlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identification-of-control-affine-systems-using-gaussian-processes">Identification of Control Affine Systems Using Gaussian Processes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gaussian-process-basics">Gaussian Process Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gp-identification-for-control-affine-systems">GP Identification for Control Affine Systems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#convergence-analysis-for-feedback-linearizing-control">Convergence Analysis for Feedback Linearizing Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#control-law">Control Law</a></li>
<li class="toctree-l4"><a class="reference internal" href="#convergence-analysis">Convergence Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tighter-bound-with-training-data">Tighter Bound with Training Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-illustration">Numerical Illustration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="murray_flatness.html">Differential Flatness of Mechanical Control Systems: A Catalogue of Prototype Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="neural_lyapnov_control.html">Neural Lyapnov Control</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../books/index.html">Books</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TechNote of soblin</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Control</a> &raquo;</li>
        
      <li>Feedback Linearization using Gaussian Process</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="feedback-linearization-using-gaussian-process">
<h1><a class="toc-backref" href="#id2">Feedback Linearization using Gaussian Process</a><a class="headerlink" href="#feedback-linearization-using-gaussian-process" title="このヘッドラインへのパーマリンク">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Jonas Umlauft, Thomas Beckers, Melanie Kimmel, Sandra Hirche</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2017</td>
</tr>
<tr class="field-odd field"><th class="field-name">Link:</th><td class="field-body"><a class="reference external" href="http://mediatum.ub.tum.de/doc/1374761/335188.pdf">link</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Accepted:</th><td class="field-body">2017 IEEE 56th Anual Conference on Decision and Control (CDC)</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="id1">
<p class="topic-title first">目次</p>
<ul class="simple">
<li><a class="reference internal" href="#feedback-linearization-using-gaussian-process" id="id2">Feedback Linearization using Gaussian Process</a><ul>
<li><a class="reference internal" href="#abstract" id="id3">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id4">Introduction</a></li>
<li><a class="reference internal" href="#probem-formlation" id="id5">Probem Formlation</a></li>
<li><a class="reference internal" href="#identification-of-control-affine-systems-using-gaussian-processes" id="id6">Identification of Control Affine Systems Using Gaussian Processes</a></li>
<li><a class="reference internal" href="#convergence-analysis-for-feedback-linearizing-control" id="id7">Convergence Analysis for Feedback Linearizing Control</a></li>
<li><a class="reference internal" href="#numerical-illustration" id="id8">Numerical Illustration</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="abstract">
<h2><a class="toc-backref" href="#id3">Abstract</a><a class="headerlink" href="#abstract" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>モデルの構造についての情報が限られているシステムの同定において，機械学習のデータ駆動アプローチは大変有用である．この論文ではノンパラメトリックベイズの手法であるガウス過程を，フィードバック線形化のためのモデル学習に用いる．適切なカーネル関数を用いることで，既存のコントローラーを用いながらシステム同定のためのデータを収集できる．同定されたモデルを用いて，フィードバック線形化に基づいた制御器を提案する．それによる(閉ループの)システムは大域的に有界である(globally uniformly ultimately bounded)ことが示される．また訓練集合と，システムが収束するboundの大きさとの関係を導く．</p>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id4">Introduction</a><a class="headerlink" href="#introduction" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>非線形系に対してフィードバック線形化を用いることで，線形制御におけるよく知られている手法を適用することが可能になる．しかしフィードバック線形化により非線形システムの非線形性を完全にキャンセルするためには，詳細なモデルが必要である．そのためフィードバック線形化を適用するためには非線形システムの詳細なシステム同定が不可欠である．しかし第一原理だけでは導出できないような複雑なダイナミクスに従うシステムに対しても制御を行うようになるにつれ，このアプローチは困難を伴う．古典的なシステム同定は観測値を用いることで，システムのパラメトリックモデルを選択しさらにチューニングを行う．そのためそもそもシステムの構造に関する情報が手に入らない場合，失敗する運命にある．データ駆動のアプローチは，少数の事前情報を用いて訓練集合以外に対しても汎化性能を示すため，gain popularityしてきた．数学的には難関であるがノンパラメトリックベイズを用いることで，ベイズの枠組みで事前知識をデータと融合し，ノンパラメトリックな柔軟性を両立することができる．</p>
<p>この論文では著者らはガウス過程(GP)に焦点を当てている．GPはすでにシステム同定にはsuccessfulに用いられている．しかし制御の観点からのformal analysisは欠落している．ガウス過程システムモデルの収束性の解析は[6][7]を参照．GPは各状態空間の領域において，推定された関数とそのモデルの信頼性を評価できるという性質があるため，安定性の解析に有用である．[9]に示されているように，GPは訓練データへの距離を測ることで真の関数値と関数の推定値の誤差の上界を与える．The knowledge of its own ignorance represents a benefit over many other representation approaches.</p>
<p>フィードバック線形化を適用するにあたって，モデルに関する情報が欠けていることに対処するため，[10]では入力が状態に与える影響は既知であるという仮定のもとでロバストな設計に着目している．[11]ではオリジナルのモデルが与えられたうえでその不確かさを考慮しているが，そもそもオリジナルのモデルをどのように得るのか言及していない．</p>
<p>main contributionは，GPを用いたシステム同定と提案するフィードバック線形化を用いる手法がglobally uniformly ultimately boundedであることを示すことにある．システム同定にはシステムのcontrol-affineな性質をカーネル関数に変換する．これによりシステムを閉ループで同定することができる．更なる解析を行うことで，情報(訓練データ)が増えるについてultimate boundがどのように減少するかが示され，訓練データ集合のサイズとシステムが収束するサイズとの間の関係を導出する．</p>
</div>
<div class="section" id="probem-formlation">
<h2><a class="toc-backref" href="#id5">Probem Formlation</a><a class="headerlink" href="#probem-formlation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>以下に示される可制御標準形の，状態フィードバックにより線形化可能なシステムを考える．</p>
<div class="math">
\begin{align*}
\dot{x}_1 &amp;= x_2 \\ \dot{x}_2 &amp;= x_3 \\ \cdots \\ \dot{x}_n &amp;= f(\boldsymbol{x}) + g(\boldsymbol{x})u \\ \boldsymbol{x}(0) &amp;= \boldsymbol{x}_0
\end{align*}</div><p>ここで状態ベクトル <span class="math">\(\boldsymbol{x} = [x_1 \cdots x_n]^{\text{T}} \in \mathcal{X} \subset \mathbb{R}^n\)</span> のすべての値が測定可能であるとする．下のようにいくつかの仮定をおく．</p>
<dl class="glossary docutils">
<dt id="term-1">仮定1</dt>
<dd>未知関数 <span class="math">\(f: \mathcal{X} \rightarrow \mathbb{R}\)</span> ， <span class="math">\(g: \mathcal{X} \rightarrow \mathbb{R}\)</span> は有界かつ無限回微分可能とする</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-2">仮定2</dt>
<dd>システムの相対次数は <span class="math">\(\boldsymbol{x} \in \mathcal{X}\)</span> においてシステムの次元nに等しい</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-3">仮定3</dt>
<dd>少なくとも一つの <span class="math">\(\boldsymbol{x} \in \mathcal{X}\)</span> において <span class="math">\(g(\boldsymbol{x})\)</span> の符号が既知である</dd>
</dl>
<p>3つ目の仮定は相対次数が不良設定とならないためのものである( <span class="math">\(g(\boldsymbol{x}) == 0\)</span> だと相対次数が定義されない)．そのためgの符号は一定である．</p>
<p>第一には未知関数 <span class="math">\(f, g\)</span> をデータから <span class="math">\(\hat{f}, \hat{g}\)</span> で近似し，次に以下のようにフィードバック線形化</p>
<div class="math">
\begin{align*}
u_f = \dfrac{1}{\hat{g}(\boldsymbol{x})} \left( -\hat{f}(\boldsymbol{x}) + \nu \right)
\end{align*}</div><p>を行う．また <span class="math">\(y = \dot{x}_n + \epsilon\)</span> が観測として得られるとする( <span class="math">\(\epsilon \sim \mathcal{N}(0, \sigma_{n}^2)\)</span> )．そして訓練集合を</p>
<div class="math">
\begin{align*}
\mathcal{D} = \left\{ \boldsymbol{x}^{(i)}, y^{(i)}\right\}_{i=1}^{N}
\end{align*}</div><p>とする．</p>
</div>
<div class="section" id="identification-of-control-affine-systems-using-gaussian-processes">
<h2><a class="toc-backref" href="#id6">Identification of Control Affine Systems Using Gaussian Processes</a><a class="headerlink" href="#identification-of-control-affine-systems-using-gaussian-processes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="gaussian-process-basics">
<h3>Gaussian Process Basics<a class="headerlink" href="#gaussian-process-basics" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ガウス過程では関数が平均関数の周辺に関数が分布するイメージである．</p>
<div class="math">
\begin{align*}
f_{GP} \sim GP(m(\boldsymbol{x}), k(\boldsymbol{x}, \boldsymbol{x}^{\prime}))
\end{align*}</div><p>このパラメーター <span class="math">\(\boldsymbol{\phi} = \{m, k\}\)</span> は推定されるべき変数であり，以下のような最適化により求められる．</p>
<blockquote>
<div><span class="math">\(\boldsymbol{\phi^{*}} = \mathrm{argmax} \log p(\boldsymbol{y}_f \mid \boldsymbol{X}, \boldsymbol{\phi})\)</span></div></blockquote>
<p>ここで</p>
<div class="math">
\begin{align*}
\log p(\boldsymbol{y}_f \mid \boldsymbol{X}, \boldsymbol{\phi}) = \dfrac{1}{2}(\boldsymbol{y}_f^{\text{T}}K\boldsymbol{y}_f - \log \det K - N \log (2\pi))
\end{align*}</div><p>where</p>
<div class="math">
\begin{align*}
X &amp;= [\boldsymbol{x}^{{1}} \cdots \boldsymbol{x}^{(N)}] \\ \boldsymbol{y}_f &amp;= [y_{f}^{(1)} \cdots y_{f}^{(N)}]
\end{align*}</div><p>である．また行列Kはデータの各組み合わせについてカーネル値を求めた</p>
<div class="math">
\begin{align*}
K = \begin{bmatrix} k(\boldsymbol{x}^{(1)}, \boldsymbol{x}^{(1)}) &amp; \cdots &amp; k(\boldsymbol{x}^{(1)}, \boldsymbol{x}^{(N)}) \\ \vdots &amp; \ddots &amp; \vdots \\ k(\boldsymbol{x}^{(N)}, \boldsymbol{x}^{(1)}) &amp; \cdots &amp; k(\boldsymbol{x}^{(N)}, \boldsymbol{x}^{(N)}) \end{bmatrix}
\end{align*}</div><p>なる行列である． <span class="math">\(\phi\)</span> に関する最適化は非凸ではあるが，勾配法などで解ける．ガウス過程による回帰では以下の結合分布を用いる．</p>
<div class="math">
\begin{align*}
\left[\begin{array}{c} f_{\mathcal{G P}}\left(\boldsymbol{x}^{*}\right) \\ \boldsymbol{y}_{f} \end{array}\right] \sim \mathcal{N}\left(\left[\begin{array}{c} m\left(\boldsymbol{x}^{*}\right) \\ \boldsymbol{m}_{\boldsymbol{X}} \end{array}\right],\left[\begin{array}{cc} k^{*} &amp; \boldsymbol{k}^{\top} \\ \boldsymbol{k} &amp; \boldsymbol{K}+\sigma_{n}^{2} \boldsymbol{I}_{N} \end{array}\right]\right)
\end{align*}</div><p>ここで <span class="math">\(\boldsymbol{m}_{\boldsymbol{X}} = [m(\boldsymbol{x}^{(1)}) \cdots m(\boldsymbol{x}^{(N)})]^{\text{T}}\)</span> である．条件付き分布を求めることで</p>
<div class="math" id="equation-eq78">
\begin{align*}
\mu\left(\boldsymbol{x}^{*}\right): &amp;=\mathbb{E}\left[f_{\mathcal{G P}}\left(\boldsymbol{x}^{*}\right) \mid \mathcal{D}\right] \\
&amp;=m\left(\boldsymbol{x}^{*}\right)+\boldsymbol{k}^{\top}\left(\boldsymbol{K}+\sigma_{n}^{2} \boldsymbol{I}_{N}\right)^{-1}\left(\boldsymbol{y}_{f}-\boldsymbol{m}_{\boldsymbol{X}}\right) \\
\sigma\left(\boldsymbol{x}^{*}\right) &amp;:=\mathbb{V}\left[f_{\mathcal{G} \mathcal{P}}\left(\boldsymbol{x}^{*}\right) \mid \mathcal{D}\right]=k^{*}-\boldsymbol{k}^{\top}\left(\boldsymbol{K}+\sigma_{n}^{2} \boldsymbol{I}_{N}\right)^{-1} \boldsymbol{k}
\end{align*}</div><p>が得られる．ただし</p>
<div class="math">
\begin{align*}
k^{*} &amp;=k\left(\boldsymbol{x}^{*}, \boldsymbol{x}^{*}\right) \\
\boldsymbol{k} &amp;=\left[k\left(\boldsymbol{x}^{(1)}, \boldsymbol{x}^{*}\right) \cdots k\left(\boldsymbol{x}^{(N)}, \boldsymbol{x}^{*}\right)\right]^{\top} \in \mathbb{R}^{N}
\end{align*}</div><p>である．</p>
<div class="section" id="expressing-structure-in-kernels">
<h4>Expressing Structure in Kernels<a class="headerlink" href="#expressing-structure-in-kernels" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>ここで述べられているのはGPを用いてどのようにfとgを分離して推定するかについてである．</p>
<div class="math">
\begin{align*}
y_{\operatorname{sum}}^{(i)}=f_{\operatorname{sum}}\left(\boldsymbol{x}^{(i)}\right)+\epsilon^{(i)}=f_{a}\left(\boldsymbol{x}^{(i)}\right)+f_{b}\left(\boldsymbol{x}^{(i)}\right)+\epsilon^{(i)}
\end{align*}</div><p>となっている場合，推定したい関数それぞれのカーネル <span class="math">\(k_a, k_b\)</span> を適当に初期化して以下の結合分布を利用する．</p>
<div class="math">
\begin{align*}
\left[\begin{array}{c}
f_{a}\left(\boldsymbol{x}^{*}\right) \\
f_{b}\left(\boldsymbol{x}^{*}\right) \\
\boldsymbol{y}_{\mathrm{sum}}
\end{array}\right] \sim \mathcal{N}\left(\mathbf{0},\left[\begin{array}{ccc}
k_{a}^{*} &amp; \mathbf{0} &amp; \boldsymbol{k}_{a}^{\top} \\
\mathbf{0} &amp; k_{b}^{*} &amp; \boldsymbol{k}_{b}^{\top} \\
\boldsymbol{k}_{a} &amp; \boldsymbol{k}_{b} &amp; \boldsymbol{K}_{a}+\boldsymbol{K}_{b}+\sigma_{n}^{2} \boldsymbol{I}_{N}
\end{array}\right]\right)
\end{align*}</div><p>ここで <span class="math">\(k_{a}^{*}, k_{b}^{*}, \boldsymbol{k}_{a}, \boldsymbol{k}_{b}, \boldsymbol{K}_{a}, \boldsymbol{K}_{b}\)</span> は <span class="math">\(k^{*}, \boldsymbol{k}\)</span> と同様に定めるとする．すると観測値 <span class="math">\(\boldsymbol{y}_{\mathrm{sum}}\)</span> で条件付けして以下の推定式を得ることができる．</p>
<div class="math">
\begin{align*}
\begin{array}{l}
f_{a}\left(\boldsymbol{x}^{*}\right) \mid \boldsymbol{y}_{\mathrm{sum}} \sim \mathcal{N}\left(\boldsymbol{k}_{a}^{\top} \boldsymbol{K}_{\mathrm{sum}}^{-1} \boldsymbol{y}_{\mathrm{sum}}, k_{a}^{*}-\boldsymbol{k}_{a}^{\top} \boldsymbol{K}_{\mathrm{sum}}^{-1} \boldsymbol{k}_{a}\right) \\
f_{b}\left(\boldsymbol{x}^{*}\right) \mid \boldsymbol{y}_{\mathrm{sum}} \sim \mathcal{N}\left(\boldsymbol{k}_{b}^{\top} \boldsymbol{K}_{\mathrm{sum}}^{-1} \boldsymbol{y}_{\mathrm{sum}}, k_{b}^{*}-\boldsymbol{k}_{b}^{\top} \boldsymbol{K}_{\mathrm{sum}}^{-1} \boldsymbol{k}_{b}\right)
\end{array}
\end{align*}</div><p>よって新しい観測値が得られるたびにこのアップデートを行うことができる．</p>
</div>
<div class="section" id="product-with-known-functions">
<h4>Product with known functions<a class="headerlink" href="#product-with-known-functions" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>未知の関数 <span class="math">\(f_h(\boldsymbol{x})\)</span> が既知の関数 <span class="math">\(h(\boldsymbol{x})\)</span> だけかけられて以下のように観測されるとする．</p>
<div class="math">
\begin{align*}
y_{\mathrm{prod}}^{(i)}=f_{\mathrm{prod}}\left(\boldsymbol{x}^{(i)}\right)+\epsilon^{(i)}=f_{h}\left(\boldsymbol{x}^{(i)}\right) h\left(\boldsymbol{x}^{(i)}\right)+\epsilon^{(i)}
\end{align*}</div><p>すると以下のような結合分布が得られる．</p>
<div class="math">
\begin{align*}
\left[\begin{array}{c}
f_{h}\left(\boldsymbol{x}^{*}\right) \\
\boldsymbol{y}_{\mathrm{prod}}
\end{array}\right] \sim \mathcal{N}\left(\mathbf{0},\left[\begin{array}{cc}
h^{*} k_{h}^{*} h^{*} &amp; h^{*} \boldsymbol{k}_{h}^{\top} \boldsymbol{H}^{\top} \\
\boldsymbol{H} \boldsymbol{k}_{h} h^{*} &amp; \boldsymbol{H}^{\top} \boldsymbol{K}_{h} \boldsymbol{H}+\sigma_{n}^{2} \boldsymbol{I}_{N}
\end{array}\right]\right)
\end{align*}</div><p>すると <span class="math">\(\boldsymbol{K}_{\mathrm{prod}} = \boldsymbol{H}^{\top}\boldsymbol{K}_h \boldsymbol{H}\)</span> として，観測値で条件付けして以下のような推定式が得られる．</p>
<div class="math">
\begin{align*}
f_{h}\left(\boldsymbol{x}^{*}\right) \mid \boldsymbol{y}_{\mathrm{prod}} \sim \mathcal{N}\left(h^{*} \boldsymbol{k}_{h}^{\top} \boldsymbol{H}^{\top} \boldsymbol{K}_{\mathrm{prod}}^{-1} \boldsymbol{y}_{\mathrm{prod}}, h^{*} k_{h}^{*} h^{*} - h^{*} \boldsymbol{k}_{h}^{\top} \boldsymbol{H}^{\top} \boldsymbol{K}_{\mathrm{prod}}^{-1} \boldsymbol{H} \boldsymbol{k}_{h} h^{*}\right)
\end{align*}</div></div>
</div>
<div class="section" id="gp-identification-for-control-affine-systems">
<h3>GP Identification for Control Affine Systems<a class="headerlink" href="#gp-identification-for-control-affine-systems" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここで実際に題意のシステムにおいて関数fgの推定を行う．それぞれの初期値(初期関数)の平均を</p>
<div class="math">
\begin{align*}
m_f(\boldsymbol{x}) &amp;= 0 \\ m_g(\boldsymbol{x}) &amp;= b_{\mu}
\end{align*}</div><p>カーネルを</p>
<div class="math">
\begin{align*}
\begin{array}{l}
k_{f}\left(\boldsymbol{x}, \boldsymbol{x}^{\prime}\right)=\sigma_{f}^{2} \exp \left(\sum_{j=1}^{n} \dfrac{\left(x_{j}-x_{j}^{\prime}\right)^{2}}{-2 l_{j, f}^{2}}\right) \\
k_{g}\left(\boldsymbol{x}, \boldsymbol{x}^{\prime}\right)=\sigma_{g}^{2} \exp \left(\sum_{j=1}^{n} \dfrac{\left(x_{j}-x_{j}^{\prime}\right)^{2}}{-2 l_{j, g}^{2}}\right)
\end{array}
\end{align*}</div><p>とする．そして(オフラインで？)</p>
<div class="math">
\begin{align*}
\boldsymbol{\phi} = \begin{bmatrix}l_{1, f} &amp; l_{1, g} &amp; \cdots &amp; l_{n, f} &amp; l_{n, g} &amp; \sigma_{f}^2 &amp; \sigma_{g}^2 &amp; \sigma_{n}^2\end{bmatrix}^{\top}
\end{align*}</div><p>を最適化しておく． <span class="math">\(\boldsymbol{U}_{0}=\operatorname{diag}\left(u_{0}\left(\boldsymbol{x}^{(1)}\right), \ldots, u_{0}\left(\boldsymbol{x}^{(N)}\right)\right)\)</span> ， <span class="math">\(u_{0}^{*} = u_{0}(\boldsymbol{x}^{*})\)</span> ， <span class="math">\(\boldsymbol{b}_{\mu} = [b_{\mu} \cdots b_{\mu}]^{\top} \in \mathbb{R}^N\)</span> として以下の結合分布</p>
<div class="math">
\begin{align*}
\left[\begin{array}{c}
f\left(\boldsymbol{x}^{*}\right) \\
g\left(\boldsymbol{x}^{*}\right) \\
\boldsymbol{y}
\end{array}\right] \sim \mathcal{N}\left(\left[\begin{array}{c}
0 \\
b_{\mu} \\
\boldsymbol{U}_{0} \boldsymbol{b}_{\boldsymbol{\mu}}
\end{array}\right],\left[\begin{array}{ccc}
k_{f}^{*} &amp; 0 &amp; \boldsymbol{k}_{f}^{\top} \\
0 &amp; k_{g}^{*} &amp; \boldsymbol{k}_{g}^{\top} \boldsymbol{U}_{0}^{\top} u_{0}^{*} \\
\boldsymbol{k}_{f} &amp; \boldsymbol{U}_{0} \boldsymbol{k}_{g} u_{0}^{*} &amp; \boldsymbol{K}_{f g}
\end{array}\right]\right)
\end{align*}</div><p>を用いると，以下のように観測データで条件付けして推定を行えば良い．</p>
<div class="math">
\begin{align*}
&amp;\hat{f}\left(\boldsymbol{x}^{*}\right):=\mu_{f}\left(\boldsymbol{x}^{*}\right)=\boldsymbol{k}_{f}^{\top} \boldsymbol{K}_{f g}^{-1}\left(\boldsymbol{y}-\boldsymbol{U}_{0} \boldsymbol{b}_{\boldsymbol{\mu}}\right)\\
&amp;\hat{g}\left(\boldsymbol{x}^{*}\right):=\mu_{g}\left(\boldsymbol{x}^{*}\right)=b_{\mu}+u_{0}^{*} \boldsymbol{k}_{g}^{\top} \boldsymbol{U}_{0} \boldsymbol{K}_{f g}^{-1}\left(\boldsymbol{y}-\boldsymbol{U}_{0} \boldsymbol{b}_{\boldsymbol{\mu}}\right)
\end{align*}</div></div>
</div>
<div class="section" id="convergence-analysis-for-feedback-linearizing-control">
<h2><a class="toc-backref" href="#id7">Convergence Analysis for Feedback Linearizing Control</a><a class="headerlink" href="#convergence-analysis-for-feedback-linearizing-control" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ここでは制御器の収束性について議論している．</p>
<div class="section" id="control-law">
<h3>Control Law<a class="headerlink" href="#control-law" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>天下り的ではあるが，</p>
<div class="math">
\begin{align*}
r = [\boldsymbol{\lambda}^{\top} 1] \boldsymbol{x}
\end{align*}</div><p>なるスカラーを考える．ここで <span class="math">\(s^{n-1} + \lambda_{n-1}s^{n-2} + \cdots + \lambda_1\)</span> は実部が負の根しか持たない(Hurwitz)．すると</p>
<div class="math">
\begin{align*}
\dot{r} = f(\boldsymbol{x}) + g(\boldsymbol{x})u_f (\boldsymbol{x}) + \boldsymbol{\lambda}^{\top}\boldsymbol{x}_{2:n}
\end{align*}</div><p>であるから，この式において入力 <span class="math">\(u_f\)</span> を別の変数 <span class="math">\(\nu = -k_c r - \boldsymbol{\lambda}^{\top}\boldsymbol{x}_{2:n}\)</span> を用いて</p>
<div class="math" id="equation-eq13">
\begin{align*}
u_f(\boldsymbol{x}) = \dfrac{1}{\hat{g}(\boldsymbol{x})} \left( -\hat{f}(\boldsymbol{x}) - k_c r - \boldsymbol{\lambda}^{\top} \boldsymbol{x}_{2:n} \right)
\end{align*}</div><p>と表すと <span class="math">\(\dot{r} = -k_c r\)</span> より <span class="math">\(r \to 0\)</span> となる．</p>
</div>
<div class="section" id="convergence-analysis">
<span id="proposition1"></span><h3>Convergence Analysis<a class="headerlink" href="#convergence-analysis" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Lyapnov関数として以下の関数を用いる．</p>
<div class="math" id="equation-eq14">
\begin{align*}
V(\boldsymbol{x}) = r^2 / 2
\end{align*}</div><p>まず <span class="math">\(\dot{V} = r \dot{r}\)</span> と</p>
<div class="math">
\begin{align*}
\dot{r} &amp;= \boldsymbol{\lambda}^{\top}\boldsymbol{x}_{1:n-1} + \dot{x}_n \\ &amp;= f(\boldsymbol{x}) + g(\boldsymbol{x})u + \boldsymbol{\lambda}^{\top}\boldsymbol{x}_{2:n}
\end{align*}</div><p>となっている． <span class="math">\(\bar{g} = g / \hat{g}\)</span> とすると <span class="math">\(u = \bar{g}(-\hat{f}(\boldsymbol{x}) + \nu)\)</span> であるから，</p>
<div class="math">
\begin{align*}
\dot{r} &amp;= f + \bar{g}(-\hat{f} -k_{c}r - \boldsymbol{\lambda}^{\top}\boldsymbol{x}_{2:n}) + \boldsymbol{\lambda}^{\top}\boldsymbol{x}_{2:n} \\ r \dot{r} &amp;= r(f - \bar{g}\hat{f}) - \bar{g}k_{c}r^2 + (1 -g)r\boldsymbol{\lambda}^{\top}\boldsymbol{x}_{2:n}
\end{align*}</div><p>と表せる．関数 <span class="math">\(f, \hat{f}, g\)</span> は有界であるから，</p>
<div class="math">
\begin{align*}
\boldsymbol{b}^{\top} \boldsymbol{x} &amp; \geq r(f-\bar{g} \hat{f}), &amp; \boldsymbol{x}^{\top} \boldsymbol{A} \boldsymbol{x} &amp; \leq \bar{g} r^{2} \\
\boldsymbol{x}^{\top} \boldsymbol{B} \boldsymbol{x} &amp; \geq(1-\bar{g}) r \boldsymbol{\lambda}^{\top} \boldsymbol{x}_{2: n}, &amp; &amp; \forall \boldsymbol{x} \in \mathcal{X}
\end{align*}</div><p>なる行列とベクトル <span class="math">\(\boldsymbol{b}, \boldsymbol{A}, \boldsymbol{B}\)</span> が存在する．これらを用いると</p>
<div class="math">
\begin{align*}
\dot{V}(\boldsymbol{x}) \leq\|\boldsymbol{b}\|\|\boldsymbol{x}\|-k_{c} \sigma_{\min }(\boldsymbol{A})\|\boldsymbol{x}\|^{2}+\sigma_{\max }(\boldsymbol{B})\|\boldsymbol{x}\|^{2}
\end{align*}</div><p>のようにして上から抑えることができて，</p>
<div class="math" id="equation-eq16">
\begin{align*}
\sigma_{\max}(B) - k_{c}^{*}\sigma_{\min}(A) &lt; 0`
\end{align*}</div><p>が成立するように <span class="math">\(k_c &gt; k_{c}^{*}\)</span> をとれれば</p>
<div class="math">
\begin{align*}
\mathcal{B}_{1}=\left\{x \in \mathcal{X} \mid\|\boldsymbol{x}\| \leq \frac{\|\boldsymbol{b}\|}{k_{c} \sigma_{\min }(\boldsymbol{A})-\sigma_{\max }(\boldsymbol{B})}\right\}
\end{align*}</div><p>以外の領域においてVは減少してくれる．</p>
</div>
<div class="section" id="tighter-bound-with-training-data">
<h3>Tighter Bound with Training Data<a class="headerlink" href="#tighter-bound-with-training-data" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここでは推定した関数の分散(カーネル関数)が訓練集合が増えるにつれて徐々に減少することを示す．
証明を簡単にするため，以下の仮定を追加する．</p>
<dl class="glossary docutils">
<dt id="term-4">仮定4</dt>
<dd><p class="first">関数 <span class="math">\(g\)</span> は既知であり，以下の <span class="math">\(f\)</span> の観測値が得られるとする．</p>
<div class="last math">
\begin{align*}
y_{f}^{(i)}=f\left(\boldsymbol{x}^{(i)}\right)+\epsilon^{(i)}=\dot{x}_{n}^{(i)}-g\left(\boldsymbol{x}^{(i)}\right) u_{0}\left(\boldsymbol{x}^{(i)}\right)+\epsilon^{(i)}
\end{align*}</div></dd>
</dl>
<p>すると <a class="reference internal" href="#equation-eq78">(1)</a> より未知関数 <span class="math">\(\hat{f}\)</span> は以下のように推定される．</p>
<div class="math" id="equation-eq17">
\begin{align*}
\hat{f}(\boldsymbol{x}):=\mu(\boldsymbol{x})=\boldsymbol{k}_{f}^{\top}\left(\boldsymbol{K}_{f}+\sigma_{n}^{2} \boldsymbol{I}_{N}\right)^{-1} \boldsymbol{y}_{f}
\end{align*}</div><dl class="glossary docutils">
<dt id="term-4">系1</dt>
<dd><a class="reference internal" href="#term-1"><span class="xref std std-term">仮定1</span></a>  <a class="reference internal" href="#term-2"><span class="xref std std-term">仮定2</span></a>  <a class="reference internal" href="#term-3"><span class="xref std std-term">仮定3</span></a>  <a class="reference internal" href="#term-4"><span class="xref std std-term">仮定4</span></a> の下で <a class="reference internal" href="#equation-eq13">(2)</a>  <a class="reference internal" href="#equation-eq17">(5)</a> を用いると，任意の <span class="math">\(k_c &gt; 0\)</span> について系は大域的一様終局的有界(globally uniformly ultimately bounded)である．</dd>
</dl>
<p>これは <a class="reference internal" href="#equation-eq16">(4)</a> において，さらに <span class="math">\(1 - \bar{g} = 0\)</span> が成立することから示される．</p>
<p>以降では <a class="reference internal" href="#equation-eq78">(1)</a> における分散の上界を与える．これはモデルの信頼性(fidelity)や訓練集合への距離を表している．</p>
<dl class="glossary docutils">
<dt id="term-4">定理2</dt>
<dd><a class="reference internal" href="#equation-eq78">(1)</a> で定義されるガウス過程の推定値の分散は以下のようにある定数により上から抑えられる．
<span class="math">\(0 &lt; \sigma( \boldsymbol{x}) &lt; \sigma_{f}^2\)</span></dd>
</dl>
<p>これは著者らの先行研究を参照していた．GPにおいては真の関数値 <span class="math">\(f(\boldsymbol{x})\)</span> と推定における平均 <span class="math">\(\mu (\boldsymbol{x})\)</span> との距離を以下の仮定の下で評価することができる．</p>
<dl class="glossary docutils">
<dt id="term-5">仮定5</dt>
<dd>有界な連続微分可能なカーネル関数 <span class="math">\(k\)</span> を用いた場合の， <span class="math">\(f(\boldsymbol{x})\)</span> の再生核ヒルベルト空間におけるノルムが， <span class="math">\(\|f(\boldsymbol{x}) \|_{k}^2 &lt; B_f\)</span> より抑えられている．</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-5">定理3</dt>
<dd><p class="first"><a class="reference internal" href="#term-5"><span class="xref std std-term">仮定5</span></a> の下で</p>
<div class="math">
\begin{align*}
\operatorname{Pr}\left\{\forall \boldsymbol{x} \in \tilde{\mathcal{X}},\left|\mu_{N}(\boldsymbol{x})-f(\boldsymbol{x})\right| \leq \beta_{N+1} \sigma_{N}(\boldsymbol{x})\right\} \geq 1-\delta
\end{align*}</div><p>がコンパクト集合 <span class="math">\(\bar{\mathcal{X}} \in \mathbb{R}^n\)</span> 上で成立する．ここで <span class="math">\(\delta \in [0, 1]\)</span></p>
<div class="math">
\begin{align*}
\beta_{N+1}=\sqrt{2 B_{f}+300 \gamma_{N+1} \log ^{3}((N+1) / \delta)}
\end{align*}</div><p class="last">である．また <span class="math">\(\gamma_{N+1}\)</span> は <span class="math">\(\boldsymbol{x}_1, \ldots \boldsymbol{x}_N\)</span> の相互情報量である．</p>
</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-5">命題2</dt>
<dd><p class="first"><a class="reference internal" href="#term-1"><span class="xref std std-term">仮定1</span></a>  <a class="reference internal" href="#term-2"><span class="xref std std-term">仮定2</span></a> <a class="reference internal" href="#term-3"><span class="xref std std-term">仮定3</span></a>  <a class="reference internal" href="#term-4"><span class="xref std std-term">仮定4</span></a>  <a class="reference internal" href="#term-5"><span class="xref std std-term">仮定5</span></a> と式 <a class="reference internal" href="#equation-eq17">(5)</a> による <span class="math">\(f(\boldsymbol{x})\)</span> の推定値，式 <a class="reference internal" href="#equation-eq13">(2)</a> による制御入力を用いると，任意の <span class="math">\(k_c &gt; 0\)</span> について閉ループシステム系は確率 <span class="math">\(1 - \delta\)</span> で以下の集合において大域的に一様に終局的に有界である．</p>
<div class="math">
\begin{align*}
\mathcal{B}_{2}=\left\{\boldsymbol{x} \in \mathcal{X} \mid\|\boldsymbol{x}\| \leq \frac{\beta_{N+1} \bar{\sigma}}{k_{c}\left\|\left[\boldsymbol{\lambda}^{\top} 1\right]\right\|}\right\}
\end{align*}</div><p class="last">ここで <span class="math">\(\bar{\sigma} &gt; \sigma(\boldsymbol{x})\)</span> が <span class="math">\(\forall \boldsymbol{x} \in \mathcal{B}_1\)</span> において成立するような上界が <span class="math">\(\bar{\sigma}\)</span> である．</p>
</dd>
<dt id="term-5">証明2</dt>
<dd><p class="first"><a class="reference internal" href="#proposition1"><span class="std std-ref">Convergence Analysis</span></a> により <span class="math">\(\mathcal{B}_1 = \bar{\mathcal{X}}\)</span> への収束は保証されている．よって <a class="reference internal" href="#term-5"><span class="xref std std-term">定理3</span></a> が適用できて， <span class="math">\(\mathcal{B}_1\)</span> 上での議論に限ればよい． <a class="reference internal" href="#equation-eq14">(3)</a> のリャプノフ関数を用いてみると <span class="math">\(g - \hat{g} = 0\)</span> である( <a class="reference internal" href="#term-4"><span class="xref std std-term">仮定4</span></a> )よりその時間変化は</p>
<div class="math" id="equation-eq18">
\begin{align*}
\dot{V}(\boldsymbol{x}) = r(f - \hat{f}) - k_c r^2
\end{align*}</div><p>で与えられる． <a class="reference internal" href="#term-5"><span class="xref std std-term">定理3</span></a> より</p>
<div class="math">
\begin{align*}
|f-\hat{f}| \leq \beta_{N+1} \bar{\sigma} \quad \Rightarrow \quad \dot{V}(\boldsymbol{x})&lt;0 \quad \forall \boldsymbol{x} \in \mathcal{X} \backslash \mathcal{B}_{2}
\end{align*}</div><p class="last">が確率 <span class="math">\(1 - \delta\)</span> で成立する．よって半径 <span class="math">\(\beta_{N+1} \bar{\sigma} / k_c\)</span> 以内への収束，すなわち <span class="math">\(\mathcal{B}_2\)</span> への収束が示される．</p>
</dd>
</dl>
<p>最後に訓練集合にデータが追加されるほど分散が減少することを示す．</p>
<dl class="glossary docutils">
<dt id="term-5">定理4<dt id="term-5">(1)</dt>
<dd>訓練集合のサイズが <span class="math">\(N, N+1\)</span> のときの分散を <span class="math">\(\sigma_{N}(\boldsymbol{x}), \sigma_{N+1}(\boldsymbol{x})\)</span> とすると，
<span class="math">\(\sigma_{N}(\boldsymbol{x})&gt;\sigma_{N+1}(\boldsymbol{x}), \quad \forall \boldsymbol{x} \in \mathcal{X}\)</span>
が成立する．</dd>
<dt id="term-5">(2)</dt>
<dd><p class="first">既存の訓練集合 <span class="math">\(\boldsymbol{x}^{(i)} (i = 1,,,N_0)\)</span> に対してテスト集合 <span class="math">\(\boldsymbol{x}^{*} = \boldsymbol{x}^{(i)} (i = N_0,,,N)\)</span> が加えられると</p>
<div class="math" id="equation-control-feedback-linearization-using-gp-0">
\begin{align*}
\lim _{N \rightarrow \infty} \sigma_{N}\left(\boldsymbol{x}^{*}\right)=0 \quad \text { with } \quad \sigma_{N}=\mathcal{O}(1 / N)
\end{align*}</div><p class="last">が成立する．</p>
</dd>
<dt id="term-5">証明(1)</dt>
<dd>式 <a class="reference internal" href="#equation-eq78">(1)</a> において <span class="math">\(\boldsymbol{k}^{\top}\left(\boldsymbol{K}+\sigma_{n}^{2} \boldsymbol{I}_{N}\right)^{-1} \boldsymbol{k}\)</span> はデータが追加されるについて単調に増加するので証明完了．</dd>
<dt id="term-5">証明(2)</dt>
<dd><p class="first">詳細は省くが以下の式</p>
<div class="math" id="equation-control-feedback-linearization-using-gp-1">
\begin{align*}
\lim _{N \rightarrow \infty} \sigma_{N}\left(\boldsymbol{x}^{*}\right) \leq \lim _{N \rightarrow \infty} \sigma_{f}^{2}\left(1-\frac{k_{0}+N}{N+\sigma_{n}^{2} / \sigma_{f}^{2}}\right)=0
\end{align*}</div><p class="last">が成立するので証明完了．</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="numerical-illustration">
<h2><a class="toc-backref" href="#id8">Numerical Illustration</a><a class="headerlink" href="#numerical-illustration" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="math">
\begin{align*}
&amp;\dot{x}_{1}=x_{2}\\
&amp;\dot{x}_{2}=\underbrace{1-\sin \left(x_{1}\right)+s\left(x_{2}\right)}_{=f(x)}+\underbrace{\left(1+\frac{1}{2} \sin \left(x_{2} / 2\right)\right)}_{=g(x)} u
\end{align*}</div></div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="murray_flatness.html" class="btn btn-neutral float-right" title="Differential Flatness of Mechanical Control Systems: A Catalogue of Prototype Systems" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, soblin.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/mathjaxconf.js"></script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>